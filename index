<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#020617">
    <title>Stellar Tarot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --app-bg: #020617;
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }
        body {
            background-color: var(--app-bg);
            color: white;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100%;
            width: 100%;
            position: fixed;
        }
        .serif { font-family: 'Crimson Pro', serif; }
        .safe-pt { padding-top: calc(var(--safe-top) + 1rem); }
        .safe-pb { padding-bottom: calc(var(--safe-bottom) + 1rem); }
        
        /* Card Flip Animation */
        .card-container { perspective: 1000px; }
        .card-inner {
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
        }
        .card-inner.flipped { transform: rotateY(180deg); }
        .card-front, .card-back {
            backface-visibility: hidden;
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            border-radius: 0.75rem;
        }
        .card-back { background: #1e1b4b; border: 2px solid #b45309; }
        .card-front { 
            background: white; 
            color: #1e1b4b; 
            transform: rotateY(180deg); 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px solid #f59e0b;
        }

        /* Screen transitions */
        .screen { display: none; }
        .screen.active { display: flex; flex-direction: column; }

        .glow {
            position: fixed;
            width: 60vw;
            height: 60vw;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.15;
        }
    </style>
</head>
<body>
    <div class="glow top-[-10%] left-[-10%] bg-indigo-500"></div>
    <div class="glow bottom-[-10%] right-[-10%] bg-purple-500"></div>

    <!-- HEADER -->
    <header class="fixed top-0 left-0 w-full z-50 bg-slate-950/80 backdrop-blur-md border-b border-white/10 safe-pt px-6 pb-4 flex justify-between items-center">
        <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-gradient-to-br from-amber-400 to-orange-600 rounded-lg flex items-center justify-center shadow-lg">
                <span class="text-white text-lg">‚ú®</span>
            </div>
            <h1 class="text-lg font-bold tracking-tight serif">Stellar Tarot</h1>
        </div>
        <div id="sign-badge" class="hidden bg-white/5 px-3 py-1 rounded-full border border-white/10">
            <span class="text-[10px] font-bold uppercase tracking-widest text-amber-400" id="current-sign-text">Sign</span>
        </div>
    </header>

    <main class="h-full pt-24 pb-safe overflow-y-auto">
        
        <!-- STEP 1: SIGN SELECTION -->
        <section id="step-1" class="screen active p-6 space-y-8 animate-in fade-in slide-in-from-bottom-4">
            <div class="text-center space-y-2 mt-4">
                <h2 class="text-3xl serif">Seek your path</h2>
                <p class="text-slate-400 text-sm">Align the cards with your zodiac energy.</p>
            </div>
            <div class="grid grid-cols-3 gap-3" id="sign-grid">
                <!-- Generated by JS -->
            </div>
        </section>

        <!-- STEP 2: DRAWING -->
        <section id="step-2" class="screen p-6 space-y-8">
            <div class="flex justify-between items-end">
                <div>
                    <h2 class="text-xl serif">Draw Three Cards</h2>
                    <p class="text-slate-400 text-xs">Past ‚Ä¢ Present ‚Ä¢ Future</p>
                </div>
                <button onclick="autoDraw()" class="text-amber-500 text-xs font-bold uppercase flex items-center gap-1">
                    üîÑ Auto
                </button>
            </div>

            <div class="flex justify-center gap-3">
                <div id="slot-0" class="flex-1 aspect-[2/3] max-w-[100px] border-2 border-dashed border-white/10 rounded-xl flex items-center justify-center">
                    <span class="text-[8px] uppercase text-white/20">Past</span>
                </div>
                <div id="slot-1" class="flex-1 aspect-[2/3] max-w-[100px] border-2 border-dashed border-white/10 rounded-xl flex items-center justify-center">
                    <span class="text-[8px] uppercase text-white/20">Present</span>
                </div>
                <div id="slot-2" class="flex-1 aspect-[2/3] max-w-[100px] border-2 border-dashed border-white/10 rounded-xl flex items-center justify-center">
                    <span class="text-[8px] uppercase text-white/20">Future</span>
                </div>
            </div>

            <div id="deck-container" class="flex-grow flex items-center justify-center py-8">
                <div class="flex -space-x-12 relative h-40" id="card-fan">
                    <!-- Cards generated by JS -->
                </div>
            </div>

            <div id="reveal-btn-container" class="hidden justify-center pb-8">
                <button onclick="revealReading()" class="w-full max-w-xs bg-gradient-to-r from-amber-500 to-orange-600 text-white h-14 rounded-2xl font-bold shadow-xl active:scale-95 transition-all">
                    Interpret My Stars
                </button>
            </div>
        </section>

        <!-- STEP 3: INTERPRETATION -->
        <section id="step-3" class="screen p-6 space-y-6">
            <div class="text-center">
                <span class="text-amber-500 text-[10px] font-bold uppercase tracking-widest">The Message</span>
                <h2 class="text-2xl serif" id="reading-title">Your Path</h2>
            </div>

            <div class="bg-white/5 backdrop-blur-md rounded-[2rem] p-8 border border-white/10 shadow-inner space-y-6">
                <p id="reading-content" class="text-slate-200 leading-relaxed text-base serif text-justify first-letter:text-3xl first-letter:text-amber-500 first-letter:font-bold">
                    The stars are aligning...
                </p>
                <div class="h-px bg-white/10 w-full"></div>
                <button onclick="resetApp()" class="w-full h-12 rounded-xl bg-white/5 border border-white/10 text-slate-300 text-xs font-bold uppercase active:bg-white/10">
                    New Reading
                </button>
            </div>
        </section>

    </main>

    <script>
        const TAROT_DECK = [
            { name: "The Fool", img: "üÉè", mean: "new beginnings and spontaneous leaps of faith" },
            { name: "The Magician", img: "ü™Ñ", mean: "the power of manifestation and using your tools" },
            { name: "The High Priestess", img: "üåô", mean: "whispers of intuition and hidden knowledge" },
            { name: "The Empress", img: "üåø", mean: "abundant creativity and nurturing energy" },
            { name: "The Emperor", img: "üëë", mean: "structure, authority, and solid foundations" },
            { name: "The Hierophant", img: "‚õ™", mean: "tradition, wisdom, and cultural beliefs" },
            { name: "The Lovers", img: "‚ù§Ô∏è", mean: "harmony in relationships and value-based choices" },
            { name: "The Chariot", img: "üèá", mean: "victory through willpower and focused drive" },
            { name: "Strength", img: "ü¶Å", mean: "inner courage and gentle persuasion" },
            { name: "The Hermit", img: "üïØÔ∏è", mean: "introspection and inner guidance" },
            { name: "Wheel of Fortune", img: "üé°", mean: "cycles of destiny and shifts in karma" },
            { name: "Justice", img: "‚öñÔ∏è", mean: "fairness, truth, and cause and effect" },
            { name: "Death", img: "üíÄ", mean: "the closing of one door and opening of another" },
            { name: "The Star", img: "‚≠ê", mean: "renewed hope and cosmic inspiration" },
            { name: "The Moon", img: "üåï", mean: "navigating the shadows of the subconscious" },
            { name: "The Sun", img: "üåû", mean: "radiant success, joy, and absolute clarity" }
        ];

        const ZODIAC_DATA = {
            "Aries": "fiery spirit", "Taurus": "grounded nature", "Gemini": "inquisitive mind",
            "Cancer": "intuitive soul", "Leo": "radiant heart", "Virgo": "analytical energy",
            "Libra": "harmonious essence", "Scorpio": "intense power", "Sagittarius": "adventurous outlook",
            "Capricorn": "disciplined resolve", "Aquarius": "original perspective", "Pisces": "dreamy connection"
        };

        let selectedSign = "";
        let drawnCards = [];

        // INITIALIZE
        function init() {
            const grid = document.getElementById('sign-grid');
            Object.keys(ZODIAC_DATA).forEach(sign => {
                const btn = document.createElement('button');
                btn.className = "aspect-square rounded-2xl bg-white/5 border border-white/10 flex flex-col items-center justify-center gap-2 active:scale-90 transition-all active:bg-amber-500/20 active:border-amber-500";
                btn.innerHTML = `<span class='text-xl'>‚òÄÔ∏è</span><span class='text-[10px] font-bold uppercase'>${sign}</span>`;
                btn.onclick = () => selectSign(sign);
                grid.appendChild(btn);
            });

            const fan = document.getElementById('card-fan');
            for(let i=0; i<8; i++) {
                const c = document.createElement('div');
                c.className = "w-16 h-28 bg-indigo-950 rounded-lg border border-amber-500/20 shadow-xl cursor-pointer active:-translate-y-4 transition-all flex items-center justify-center";
                c.style.transform = `rotate(${(i - 3.5) * 10}deg)`;
                c.innerHTML = `<span class='opacity-20'>üåô</span>`;
                c.onclick = () => drawManual(i);
                fan.appendChild(c);
            }
        }

        function selectSign(sign) {
            selectedSign = sign;
            document.getElementById('sign-badge').classList.remove('hidden');
            document.getElementById('current-sign-text').innerText = sign;
            showScreen('step-2');
        }

        function drawManual(idx) {
            if (drawnCards.length >= 3) return;
            const card = TAROT_DECK[Math.floor(Math.random() * TAROT_DECK.length)];
            if (drawnCards.find(c => c.name === card.name)) return drawManual(idx);
            
            addCardToSlot(card);
        }

        function autoDraw() {
            drawnCards = [];
            for (let i = 0; i < 3; i++) {
                let card;
                do {
                    card = TAROT_DECK[Math.floor(Math.random() * TAROT_DECK.length)];
                } while (drawnCards.find(c => c.name === card.name));
                addCardToSlot(card);
            }
        }

        function addCardToSlot(card) {
            const slotIdx = drawnCards.length;
            drawnCards.push(card);
            const slot = document.getElementById(`slot-${slotIdx}`);
            slot.innerHTML = `
                <div class="bg-white text-indigo-950 w-full h-full rounded-xl flex flex-col items-center justify-center p-2 animate-bounce">
                    <span class="text-2xl">${card.img}</span>
                    <span class="text-[7px] font-bold uppercase text-center mt-1">${card.name}</span>
                </div>
            `;
            if (drawnCards.length === 3) {
                document.getElementById('reveal-btn-container').classList.remove('hidden');
                document.getElementById('reveal-btn-container').classList.add('flex');
            }
        }

        function revealReading() {
            showScreen('step-3');
            const [p, pr, f] = drawnCards;
            const trait = ZODIAC_DATA[selectedSign];
            
            const text = `As a ${selectedSign}, your ${trait} is currently vibrating with the universe. In your past, ${p.name} shows ${p.mean}. This leads to today, where ${pr.name} reveals you are feeling ${pr.mean}. Looking ahead, ${f.name} promises ${f.mean}. Trust your ${selectedSign} heart.`;
            
            document.getElementById('reading-content').innerText = text;
            document.getElementById('reading-title').innerText = `The Path of ${selectedSign}`;
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function resetApp() {
            selectedSign = "";
            drawnCards = [];
            document.getElementById('sign-badge').classList.add('hidden');
            document.getElementById('reveal-btn-container').classList.add('hidden');
            for(let i=0; i<3; i++) {
                document.getElementById(`slot-${i}`).innerHTML = `<span class="text-[8px] uppercase text-white/20">${i===0?'Past':i===1?'Present':'Future'}</span>`;
            }
            showScreen('step-1');
        }

        window.onload = init;
    </script>
</body>
</html>
